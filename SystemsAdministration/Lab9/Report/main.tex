\documentclass[12pt]{article}
\usepackage[T1, T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{hyperref}
\usepackage{graphicx}
\graphicspath{ {../Images/} }

\author{Григорий Матюхин}
\date{\today}
\title{Лабораторная работа \textnumero9.\\Управление \texttt{SELinux}}

\begin{document}
\maketitle
\newpage
\tableofcontents
\newpage
\section{Цель работы}
Получить навыки работы с контекстом безопасности и политиками \texttt{SELinux}.

\section{Последовательность выполнения работы}
\subsection{Управление режимами SELinux}
\begin{enumerate}
	\item Запустите терминал и получите полномочия администратора:
	\item Просмотрите текущую информацию о состоянии \texttt{SELinux}:
	\item Посмотрите, в каком режиме работает \texttt{SELinux}:
	\item Измените режим работы \texttt{SELinux} на разрешающий (\texttt{Permissive}):
	\item В файле \texttt{/etc/sysconfig/selinux} с помощью редактора установите \texttt{SELINUX=disabled}. Перезагрузите систему.
	\item После перезагрузки запустите терминал и получите полномочия администратора.
	\item Посмотрите статус \texttt{SELinux}:
	\item Попробуйте переключить режим работы \texttt{SELinux}:
	\item Откройте файл \texttt{/etc/sysconfig/selinux} с помощью редактора и установите \texttt{SELINUX=enforcing}. Перезагрузите систему.
	\item Во время загрузки системы вы, скорее, всего получите предупреждающее сообщение о необходимости восстановления меток \texttt{SELinux}, что может занять некоторое время, а также потребует дополнительной перезагрузки системы.
	\item После перезагрузки в терминале с полномочиями администратора просмотрите текущую информацию о состоянии \texttt{SELinux}. Убедитесь, что система работает в принудительном режиме (\texttt{enforcing}) использования \texttt{SELinux}.
\end{enumerate}

\subsection{Использование restorecon для восстановления контекста безопасности}
\begin{enumerate}
	\item Запустите терминал и получите полномочия администратора.
	\item Посмотрите контекст безопасности файла \texttt{/etc/hosts}:
	\item Скопируйте файл \texttt{/etc/hosts} в домашний каталог. Проверьте контекст файла \texttt{~/hosts}:
	\item Попытайтесь перезаписать существующий файл \texttt{hosts} из домашнего каталога в каталог \texttt{/etc}:
	\item Убедитесь, что тип контекста по-прежнему установлен на \texttt{admin\_home\_t}:
	\item Исправьте контекст безопасности:
	\item Убедитесь, что тип контекста изменился:
	\item Для массового исправления контекста безопасности на файловой системе введите \texttt{touch /.autorelabel} и перезагрузите систему. Во время перезапуска не забудьте нажать клавишу \texttt{Esc} на клавиатуре, чтобы вы видели загрузочные сообщения. Вы увидите, что файловая система автоматически перемаркирована.
\end{enumerate}

\subsection{Настройка контекста безопасности для нестандартного расположения файлов веб-сервера}
\begin{enumerate}
	\item Запустите терминал и получите полномочия администратора.
	\item Установите необходимое программное обеспечение:
	\item Создайте новое хранилище для файлов web-сервера:
	\item Создайте файл \texttt{index.html} в каталоге с контентом веб-сервера \texttt{Welcome to my web-server}
	\item В файле \texttt{/etc/httpd/conf/httpd.conf} закомментируйте строку \texttt{DocumentRoot "/var/www/html"} и ниже добавьте строку \texttt{DocumentRoot "/web"} Затем в этом же файле ниже закомментируйте раздел \\
	      \begin{verbatim}
          <Directory "/var/www">
            AllowOverride None
            Require all granted
          </Directory>
        \end{verbatim}
	      и добавьте следующий раздел, определяющий правила доступа \\
	      \begin{verbatim}
          <Directory "/web">
            AllowOverride None
            Require all granted
          </Directory>
        \end{verbatim}
	\item Запустите веб-сервер и службу \texttt{httpd}:
	\item В терминале под учётной записью своего пользователя при обращении к веб-серверу в текстовом браузере \texttt{lynx}:
	\item В терминале с полномочиями администратора переключите \texttt{SELinux} в разрешающий режим:
	\item В терминале под учётной записью своего пользователя снова обратитесь к веб-серверу:
	\item В терминале с полномочиями администратора примените новую метку контекста к \texttt{/web}:
	\item Восстановите контекст безопасности:
	\item Установите \texttt{SELinux} в режим принудительного исполнения:
	\item В терминале под учётной записью своего пользователя снова обратитесь к веб-серверу. Теперь вы получите доступ к своей пользовательской веб-странице.
\end{enumerate}

\subsection{Работа с переключателями SELinux}
\begin{enumerate}
	\item Запустите терминал и получите полномочия администратора.
	\item Посмотрите список переключателей \texttt{SELinux} для службы ftp:
	\item Для службы \texttt{ftpd\_anon} посмотрите список переключателей с пояснением, за что отвечает каждый переключатель, включён он или выключен:
	\item Измените текущее значение переключателя для службы \texttt{ftpd\_anon\_write} с \texttt{off} на \texttt{on}:
	\item Повторно посмотрите список переключателей \texttt{SELinux} для службы \texttt{ftpd\_anon\_write}:
	\item Посмотрите список переключателей с пояснением:
	\item Измените постоянное значение переключателя для службы \texttt{ftpd\_anon\_write} с \texttt{off} на \texttt{on}:
	\item Посмотрите список переключателей:
\end{enumerate}

\section{Контрольные вопросы}
\begin{enumerate}
	\item Вы хотите временно поставить \texttt{SELinux} в разрешающем режиме. Какую команду вы используете?
	\item Вам нужен список всех доступных переключателей \texttt{SELinux}. Какую команду вы используете?
	\item Каково имя пакета, который требуется установить для получения легко читаемых сообщений журнала \texttt{SELinux} в журнале аудита?
	\item Какие команды вам нужно выполнить, чтобы применить тип контекста \texttt{httpd\_sys\_content\_t} к каталогу \texttt{/web}?
	\item Какой файл вам нужно изменить, если вы хотите полностью отключить \texttt{SELinux}?
	\item Где \texttt{SELinux} регистрирует все свои сообщения?
	\item Вы не знаете, какие типы контекстов доступны для службы ftp. Какая команда позволяет получить более конкретную информацию?
	\item Ваш сервис работает не так, как ожидалось, и вы хотите узнать, связано ли это с \texttt{SELinux} или чем-то ещё. Какой самый простой способ узнать?
\end{enumerate}

\section{Вывод}
В ходе выполнения данной работы я получилнавыки работы с контекстом безопасности и политиками \texttt{SELinux}.

\end{document}
